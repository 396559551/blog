(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{565:function(e,t,a){"use strict";a.r(t);var v=a(6),_=Object(v.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"vue响应式原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue响应式原理"}},[e._v("#")]),e._v(" vue响应式原理")]),e._v(" "),a("ol",[a("li",[e._v("vue怎么知道数据改变")]),e._v(" "),a("li",[e._v("vue在数据改变时，怎么知道通知哪些视图更新")]),e._v(" "),a("li",[e._v("vue在数据改变时，视图怎么知道什么时候更新")])]),e._v(" "),a("p",[e._v("下面就会涉及到三个重要的概念：")]),e._v(" "),a("ul",[a("li",[e._v("Object.defineProperty")]),e._v(" "),a("li",[e._v("依赖收集")]),e._v(" "),a("li",[e._v("依赖更新")])]),e._v(" "),a("h4",{attrs:{id:"object-defineproperty"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#object-defineproperty"}},[e._v("#")]),e._v(" Object.defineProperty")]),e._v(" "),a("p",[e._v("Objiect.defineProperty可以为对象的每一个属性，设置get和set方法")]),e._v(" "),a("p",[a("strong",[e._v("那么 get 和 set 方法有什么用？")])]),e._v(" "),a("p",[e._v("get 值是一个函数，当属性被"),a("strong",[e._v("访问")]),e._v("时，会触发 get 函数")]),e._v(" "),a("p",[e._v("set 值同样是一个函数，当属性被"),a("strong",[e._v("赋值")]),e._v("时，会触发 set 函数")]),e._v(" "),a("p",[e._v("Vue 是怎么知道数据改变的呢？")]),e._v(" "),a("p",[e._v("恩，Vue 在 属性的 set 方法中做了手脚，因而当数据改变时，触发 属性的 set 方法，Vue 就能知道数据有改变")]),e._v(" "),a("h4",{attrs:{id:"依赖收集"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#依赖收集"}},[e._v("#")]),e._v(" 依赖收集")]),e._v(" "),a("p",[e._v("data中的声明的每个属性，都拥有一个数组，保存着谁依赖(使用)了它")]),e._v(" "),a("p",[a("strong",[e._v("举个例子")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('new Vue({    \n    data(){        \n        return {            \n            name:"神仙朱"        \n        }    \n    }\n})\n')])])]),a("p",[e._v("然后 页面A 引用了name")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<div>{{name}}</div>\n")])])]),a("p",[e._v("此时，name 把 页面 A 存在它的后宫中（这个页面依赖我）")]),e._v(" "),a("p",[a("strong",[e._v("为什么呢？")])]),e._v(" "),a("p",[e._v("因为它知道谁依赖它之后，它就可以在发生改变的时候，通知 依赖它的页面，从而让页面完成更新。")]),e._v(" "),a("p",[e._v("这就是依赖收集，把 依赖了我（使用了我的东西），统统保存起来。")]),e._v(" "),a("p",[e._v("可是，保存在哪里，具体保存的是什么东西，？？？")]),e._v(" "),a("p",[e._v("保存的实际上是 页面A的 Watcher。")]),e._v(" "),a("p",[a("strong",[e._v("总结一下")])]),e._v(" "),a("p",[e._v("1、data 中每个声明的属性，都会有一个 专属的依赖收集器 subs")]),e._v(" "),a("p",[e._v("2、当页面使用到 某个属性时，页面的 watcher 就会被 放到 依赖收集器 subs 中")]),e._v(" "),a("p",[e._v("数据 是在什么时候进行 收集依赖 的呢？")]),e._v(" "),a("p",[e._v("答案是，"),a("strong",[e._v("ObjectdefineProperty- get")])]),e._v(" "),a("p",[e._v("当 页面 A 读取了 name 时，会触发 name 的 get 函数，此时，name 就会保存 页面A 的 watcher 啦！")]),e._v(" "),a("h4",{attrs:{id:"依赖更新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#依赖更新"}},[e._v("#")]),e._v(" 依赖更新")]),e._v(" "),a("p",[e._v("每个属性都会有一个专属依赖收集器subs")]),e._v(" "),a("h5",{attrs:{id:"数据是在什么时候进行依赖更新的呢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据是在什么时候进行依赖更新的呢"}},[e._v("#")]),e._v(" 数据是在什么时候进行依赖更新的呢？")]),e._v(" "),a("p",[e._v("Object.defineProperty-set")]),e._v(" "),a("p",[e._v("以上面的例子")]),e._v(" "),a("p",[e._v("当name改变的时候，name会遍历自己的依赖收集器subs，逐个通知watcher，让watcher完成更新。")]),e._v(" "),a("p",[e._v("这便可以回答了我开篇的第二个问题，")]),e._v(" "),a("p",[e._v("Vue 在数据改变时，视图怎么知道什么时候更新?")]),e._v(" "),a("p",[e._v("在数据变化触发 set 函数时，通知视图，视图开始更新")]),e._v(" "),a("h3",{attrs:{id:"综上"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#综上"}},[e._v("#")]),e._v(" 综上")]),e._v(" "),a("ol",[a("li",[e._v("Object.defineProperty - getter ，用于 依赖收集")]),e._v(" "),a("li",[e._v("Object.defineProperty - setter，用于 依赖更新")]),e._v(" "),a("li",[e._v("每个 data 声明的属性，都拥有一个的专属依赖收集器 subs")]),e._v(" "),a("li",[e._v("依赖收集器 subs 保存的依赖是 watcher")]),e._v(" "),a("li",[e._v("watcher 可用于 进行视图更新")])]),e._v(" "),a("h3",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[e._v("#")]),e._v(" 总结")]),e._v(" "),a("p",[e._v("最后，通过解释官方的图来做个总结。")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://pic3.zhimg.com/80/v2-abc8633ff694fe9aef01c0673dcac976_720w.jpg",alt:"img"}})]),e._v(" "),a("p",[e._v("**1、第一步：**通过 observer 进行数据劫持，然后在需要订阅的地方（如：模版编译），添加观察者（watcher），并立刻通过取值操作触发指定属性的 getter 方法，从而将观察者添加进 Dep （利用了闭包的特性，进行依赖收集），")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://pic3.zhimg.com/80/v2-f750a195dba1d0b5ab73b50edc3d8ffa_720w.jpg",alt:"img"}})]),e._v(" "),a("p",[e._v("**2、第二步：**当data属性发生改变 Setter 触发的时候，就会遍历sub里所有的watcher对象，进行 notify通知给所有观察者并进行相应的 update")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s?__biz=MzUxNjQ1NjMwNw==&mid=2247483922&idx=1&sn=228ca8365d8566d59630d5bad4bf7d58&chksm=f9a6680eced1e118b628499600abd12d622083a0434673514cd5da4cc69a9325c555c051c147&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考链接"),a("OutboundLink")],1)]),e._v(" "),a("p",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/88648401",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考链接"),a("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=_.exports}}]);