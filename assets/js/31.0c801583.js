(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{536:function(v,_,t){"use strict";t.r(_);var s=t(6),r=Object(s.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h3",{attrs:{id:"https"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#https"}},[v._v("#")]),v._v(" https")]),v._v(" "),t("p",[v._v("https与http的区别就是： "),t("strong",[v._v("在请求前，会建立ssl链接，确保接下来的通信都是加密的，无法被轻易截取分析")])]),v._v(" "),t("p",[v._v("一般来说，主要关注的就是SSL/TLS的握手流程，如下（简述）：")]),v._v(" "),t("ol",[t("li",[v._v("浏览器请求建立SSL链接，并向服务端发送一个随机数–Client random和客户端支持的加密方法，比如RSA加密，此时是明文传输。")]),v._v(" "),t("li",[v._v("服务端从中选出一组加密算法与Hash算法，回复一个随机数–Server random，并将自己的身份信息以证书的形式发回给浏览器 （证书里包含了网站地址，非对称加密的公钥，以及证书颁发机构等信息）")]),v._v(" "),t("li",[v._v("浏览器收到服务端的证书后 - 验证证书的合法性（颁发机构是否合法，证书中包含的网址是否和正在访问的一样），如果证书信任，则浏览器会显示一个小锁头，否则会有提示 - 用户接收证书后（不管信不信任），浏览会生产新的随机数–Premaster secret，然后证书中的公钥以及指定的加密方法加密"),t("code",[v._v("Premaster secret")]),v._v("，发送给服务器。 - 利用Client random、Server random和Premaster secret通过一定的算法生成HTTP链接数据传输的对称加密key-"),t("code",[v._v("session key")]),v._v(" - 使用约定好的HASH算法计算握手消息，并使用生成的"),t("code",[v._v("session key")]),v._v("对消息进行加密，最后将之前生成的所有信息发送给服务端。")]),v._v(" "),t("li",[v._v("服务端收到浏览器的回复 - 利用已知的加解密方式与自己的私钥进行解密，获取"),t("code",[v._v("Premaster secret")]),v._v(" - 和浏览器相同规则生成"),t("code",[v._v("session key")]),v._v(" - 使用"),t("code",[v._v("session key")]),v._v("解密浏览器发来的握手消息，并验证Hash是否与浏览器发来的一致 - 使用"),t("code",[v._v("session key")]),v._v("加密一段握手消息，发送给浏览器")]),v._v(" "),t("li",[v._v("浏览器解密并计算握手消息的HASH，如果与服务端发来的HASH一致，此时握手过程结束，")])]),v._v(" "),t("h1",{attrs:{id:"https的加密原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#https的加密原理"}},[v._v("#")]),v._v(" HTTPS的加密原理")]),v._v(" "),t("h2",{attrs:{id:"为什么需要加密"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要加密"}},[v._v("#")]),v._v(" "),t("strong",[v._v("为什么需要加密？")])]),v._v(" "),t("p",[v._v("因为http的内容是明文传输的，明文数据会经过中间代理服务器、路由器、wifi热点、通信服务运营商等多个物理节点，如果信息在传输过程中被劫持，传输的内容就完全暴露了")]),v._v(" "),t("h2",{attrs:{id:"对称加密"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#对称加密"}},[v._v("#")]),v._v(" "),t("strong",[v._v("对称加密")])]),v._v(" "),t("p",[t("strong",[v._v("如果通信双方都各自持有同一个密钥，且没有别人知道，这两方的通信安全当然是可以被保证的（除非密钥被破解）。")])]),v._v(" "),t("p",[v._v("然而最大的问题就是"),t("strong",[v._v("这个密钥怎么让传输的双方知晓，同时不被别人知道")]),v._v("。")]),v._v(" "),t("p",[v._v("浏览器只要预存好世界上所有HTTPS网站的密钥就行了！这么做显然不现实。")]),v._v(" "),t("p",[v._v("怎么办？所以我们就需要"),t("code",[v._v("非对称加密")]),v._v(" 。")]),v._v(" "),t("h2",{attrs:{id:"非对称加密"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#非对称加密"}},[v._v("#")]),v._v(" "),t("strong",[v._v("非对称加密")])]),v._v(" "),t("p",[v._v("两把密钥，通常一把叫做公钥、一把叫私钥，用公钥加密的内容必须用私钥才能解开，同样，私钥加密的内容只有公钥能解开。")]),v._v(" "),t("p",[v._v("我们可能会有这种思路：服务器先把公钥以明文方式传输给浏览器，之后浏览器向服务器传数据前都先用这个公钥加密好再传，这条数据的安全似乎可以保障了！"),t("strong",[v._v("因为只有服务器有相应的私钥能解开公钥加密的数据")]),v._v("。")]),v._v(" "),t("p",[v._v("然而反过来"),t("strong",[v._v("由服务器到浏览器的这条路怎么保障安全？"),t("strong",[v._v("如果服务器用它的私钥加密数据传给浏览器，那么浏览器用公钥可以解密它，而这个公钥是一开始通过明文传输给浏览器的，若这个公钥被中间人劫持到了，那他也能用该公钥解密服务器传来的信息了。所以")]),v._v("目前似乎只能保证由浏览器向服务器传输数据的安全性")])]),v._v(" "),t("h2",{attrs:{id:"非对称加密方案-似乎可以"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#非对称加密方案-似乎可以"}},[v._v("#")]),v._v(" "),t("strong",[v._v("非对称加密方案，似乎可以？")])]),v._v(" "),t("p",[v._v("我们已经理解通过一组公钥私钥，可以保证单个方向传输的安全性，那用两组公钥私钥，是否就能保证双向传输都安全了？请看下面的过程：")]),v._v(" "),t("ol",[t("li",[v._v("某网站服务器拥有公钥A与对应的私钥A’；浏览器拥有公钥B与对应的私钥B’。")]),v._v(" "),t("li",[v._v("浏览器把公钥B明文传输给服务器。")]),v._v(" "),t("li",[v._v("服务器把公钥A明文给传输浏览器。")]),v._v(" "),t("li",[v._v("之后浏览器向服务器传输的内容都用公钥A加密，服务器收到后用私钥A’解密。由于只有服务器拥有私钥A’，所以能保证这条数据的安全。")]),v._v(" "),t("li",[v._v("同理，服务器向浏览器传输的内容都用公钥B加密，浏览器收到后用私钥B’解密。同上也可以保证这条数据的安全。")])]),v._v(" "),t("p",[v._v("这种非对称加密算法非常耗时")]),v._v(" "),t("h2",{attrs:{id:"非对称加密-对称加密-https采用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#非对称加密-对称加密-https采用"}},[v._v("#")]),v._v(" "),t("strong",[v._v("非对称加密+对称加密")]),v._v("（HTTPS采用）")]),v._v(" "),t("ol",[t("li",[v._v("某网站拥有用于非对称加密的公钥A、私钥A’。")]),v._v(" "),t("li",[v._v("浏览器向网站服务器请求，服务器把公钥A明文给传输浏览器。")]),v._v(" "),t("li",[v._v("浏览器随机生成一个用于对称加密的密钥X，用公钥A加密后传给服务器。")]),v._v(" "),t("li",[v._v("服务器拿到后用私钥A’解密得到密钥X。")]),v._v(" "),t("li",[v._v("这样双方就都拥有密钥X了，且别人无法知道它。之后双方所有数据都通过密钥X加密解密即可。")])]),v._v(" "),t("p",[v._v("还是有漏洞的：")]),v._v(" "),t("ol",[t("li",[v._v("某网站有用于非对称加密的公钥A、私钥A’。")]),v._v(" "),t("li",[v._v("浏览器向网站服务器请求，服务器把公钥A明文给传输浏览器。")]),v._v(" "),t("li",[t("strong",[v._v("中间人劫持到公钥A，保存下来，把数据包中的公钥A替换成自己伪造的公钥B（它当然也拥有公钥B对应的私钥B’）")]),v._v("。")]),v._v(" "),t("li",[v._v("浏览器生成一个用于对称加密的密钥X，用"),t("strong",[v._v("公钥B")]),v._v("（浏览器无法得知公钥被替换了）加密后传给服务器。")]),v._v(" "),t("li",[t("strong",[v._v("中间人劫持后用私钥B’解密得到密钥X，再用公钥A加密后传给服务器")]),v._v("。")]),v._v(" "),t("li",[v._v("服务器拿到后用私钥A’解密得到密钥X。")])]),v._v(" "),t("p",[t("strong",[v._v("根本原因是浏览器无法确认收到的公钥是不是网站自己的")])]),v._v(" "),t("h2",{attrs:{id:"如何证明浏览器收到的公钥一定是该网站的公钥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如何证明浏览器收到的公钥一定是该网站的公钥"}},[v._v("#")]),v._v(" "),t("strong",[v._v("如何证明浏览器收到的公钥一定是该网站的公钥")])]),v._v(" "),t("p",[t("strong",[v._v("CA机构")]),v._v("，它是如今互联网世界正常运作的前提，而CA机构颁发的“身份证”就是"),t("strong",[v._v("数字证书")]),v._v("。")]),v._v(" "),t("p",[v._v("网站在使用HTTPS前，需要向"),t("strong",[v._v("CA机构")]),v._v("申领一份"),t("strong",[v._v("数字证书")]),v._v("，数字证书里含有证书持有者信息、公钥信息等。服务器把证书传输给浏览器，浏览器从证书里获取公钥就行了，证书就如身份证，证明“该公钥对应该网站”")]),v._v(" "),t("h2",{attrs:{id:"如何放防止数字证书被篡改"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如何放防止数字证书被篡改"}},[v._v("#")]),v._v(" "),t("strong",[v._v("如何放防止数字证书被篡改？")])]),v._v(" "),t("p",[v._v("我们把证书原本的内容生成一份“签名”，比对证书内容和签名是否一致就能判别是否被篡改。这就是数字证书的“防伪技术”，这里的“签名”就叫"),t("code",[v._v("数字签名")])]),v._v(" "),t("p",[v._v("数字签名的制作过程：")]),v._v(" "),t("ol",[t("li",[v._v("CA机构拥有非对称加密的私钥和公钥。")]),v._v(" "),t("li",[v._v("CA机构对证书明文数据T进行hash。")]),v._v(" "),t("li",[v._v("对hash后的值用私钥加密，得到数字签名S。")])]),v._v(" "),t("p",[v._v("浏览器验证过程：")]),v._v(" "),t("ol",[t("li",[v._v("拿到证书，得到明文T，签名S。")]),v._v(" "),t("li",[v._v("用CA机构的公钥对S解密（由于是浏览器信任的机构，所以浏览器保有它的公钥），得到S’。")]),v._v(" "),t("li",[v._v("用证书里指明的hash算法对明文T进行hash得到T’。")]),v._v(" "),t("li",[v._v("显然通过以上步骤，T’应当等于S‘，除非明文或签名被篡改。所以此时比较S’是否等于T’，等于则表明证书可信。")])]),v._v(" "),t("p",[t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/43789231",target:"_blank",rel:"noopener noreferrer"}},[v._v("参考链接"),t("OutboundLink")],1)])])}),[],!1,null,null,null);_.default=r.exports}}]);